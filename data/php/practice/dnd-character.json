{
  "language": "php",
  "slug": "dnd-character",
  "docs": {
    "instructions": "# Instructions\r\n\r\nFor a game of [Dungeons & Dragons][dnd], each player starts by generating a character they can play with.\r\nThis character has, among other things, six abilities; strength, dexterity, constitution, intelligence, wisdom and charisma.\r\nThese six abilities have scores that are determined randomly.\r\nYou do this by rolling four 6-sided dice and recording the sum of the largest three dice.\r\nYou do this six times, once for each ability.\r\n\r\nYour character's initial hitpoints are 10 + your character's constitution modifier.\r\nYou find your character's constitution modifier by subtracting 10 from your character's constitution, divide by 2 and round down.\r\n\r\nWrite a random character generator that follows the above rules.\r\n\r\nFor example, the six throws of four dice may look like:\r\n\r\n- 5, 3, 1, 6: You discard the 1 and sum 5 + 3 + 6 = 14, which you assign to strength.\r\n- 3, 2, 5, 3: You discard the 2 and sum 3 + 5 + 3 = 11, which you assign to dexterity.\r\n- 1, 1, 1, 1: You discard the 1 and sum 1 + 1 + 1 = 3, which you assign to constitution.\r\n- 2, 1, 6, 6: You discard the 1 and sum 2 + 6 + 6 = 14, which you assign to intelligence.\r\n- 3, 5, 3, 4: You discard the 3 and sum 5 + 3 + 4 = 12, which you assign to wisdom.\r\n- 6, 6, 6, 6: You discard the 6 and sum 6 + 6 + 6 = 18, which you assign to charisma.\r\n\r\nBecause constitution is 3, the constitution modifier is -4 and the hitpoints are 6.\r\n\r\n~~~~exercism/note\r\nMost programming languages feature (pseudo-)random generators, but few programming languages are designed to roll dice.\r\nOne such language is [Troll][troll].\r\n\r\n[troll]: https://di.ku.dk/Ansatte/?pure=da%2Fpublications%2Ftroll-a-language-for-specifying-dicerolls(84a45ff0-068b-11df-825d-000ea68e967b)%2Fexport.html\r\n~~~~\r\n\r\n[dnd]: https://en.wikipedia.org/wiki/Dungeons_%26_Dragons\r\n",
    "instructions_append": "",
    "hints": ""
  },
  "starter_code": {
    "DndCharacter.php": "<?php\r\n\r\n/*\r\n * By adding type hints and enabling strict type checking, code can become\r\n * easier to read, self-documenting and reduce the number of potential bugs.\r\n * By default, type declarations are non-strict, which means they will attempt\r\n * to change the original type to match the type specified by the\r\n * type-declaration.\r\n *\r\n * In other words, if you pass a string to a function requiring a float,\r\n * it will attempt to convert the string value to a float.\r\n *\r\n * To enable strict mode, a single declare directive must be placed at the top\r\n * of the file.\r\n * This means that the strictness of typing is configured on a per-file basis.\r\n * This directive not only affects the type declarations of parameters, but also\r\n * a function's return type.\r\n *\r\n * For more info review the Concept on strict type checking in the PHP track\r\n * <link>.\r\n *\r\n * To disable strict typing, comment out the directive below.\r\n */\r\n\r\ndeclare(strict_types=1);\r\n\r\nclass DndCharacter\r\n{\r\n    public function __construct()\r\n    {\r\n        throw new \\BadFunctionCallException(\"Please implement the DndCharacter class!\");\r\n    }\r\n\r\n    // Add methods as expected by the tests\r\n}\r\n"
  },
  "tests": {
    "DndCharacterTest.php": "<?php\r\n\r\ndeclare(strict_types=1);\r\n\r\nuse PHPUnit\\Framework\\TestCase;\r\nuse PHPUnit\\Framework\\Attributes\\TestDox;\r\n\r\nclass DndCharacterTest extends TestCase\r\n{\r\n    public static function setUpBeforeClass(): void\r\n    {\r\n        require_once 'DndCharacter.php';\r\n    }\r\n\r\n    /**\r\n     * uuid 1e9ae1dc-35bd-43ba-aa08-e4b94c20fa37\r\n     */\r\n    #[TestDox('Ability modifier - ability modifier for score 3 is -4')]\r\n    public function testAbilityModifierFor3IsNegative4()\r\n    {\r\n        $this->assertEquals(-4, DndCharacter::modifier(3));\r\n    }\r\n\r\n    /**\r\n     * uuid cc9bb24e-56b8-4e9e-989d-a0d1a29ebb9c\r\n     */\r\n    #[TestDox('Ability modifier - ability modifier for score 4 is -3')]\r\n    public function testAbilityModifierFor4IsNegative3()\r\n    {\r\n        $this->assertEquals(-3, DndCharacter::modifier(4));\r\n    }\r\n\r\n    /**\r\n     * uuid 5b519fcd-6946-41ee-91fe-34b4f9808326\r\n     */\r\n    #[TestDox('Ability modifier - ability modifier for score 5 is -3')]\r\n    public function testAbilityModifierFor5IsNegative3()\r\n    {\r\n        $this->assertEquals(-3, DndCharacter::modifier(5));\r\n    }\r\n\r\n    /**\r\n     * uuid dc2913bd-6d7a-402e-b1e2-6d568b1cbe21\r\n     */\r\n    #[TestDox('Ability modifier - ability modifier for score 6 is -2')]\r\n    public function testAbilityModifierFor6IsNegative2()\r\n    {\r\n        $this->assertEquals(-2, DndCharacter::modifier(6));\r\n    }\r\n\r\n    /**\r\n     * uuid 099440f5-0d66-4b1a-8a10-8f3a03cc499f\r\n     */\r\n    #[TestDox('Ability modifier - ability modifier for score 7 is -2')]\r\n    public function testAbilityModifierFor7IsNegative2()\r\n    {\r\n        $this->assertEquals(-2, DndCharacter::modifier(7));\r\n    }\r\n\r\n    /**\r\n     * uuid cfda6e5c-3489-42f0-b22b-4acb47084df0\r\n     */\r\n    #[TestDox('Ability modifier - ability modifier for score 8 is -1')]\r\n    public function testAbilityModifierFor8IsNegative1()\r\n    {\r\n        $this->assertEquals(-1, DndCharacter::modifier(8));\r\n    }\r\n\r\n    /**\r\n     * uuid c70f0507-fa7e-4228-8463-858bfbba1754\r\n     */\r\n    #[TestDox('Ability modifier - ability modifier for score 9 is -1')]\r\n    public function testAbilityModifierFor9IsNegative1()\r\n    {\r\n        $this->assertEquals(-1, DndCharacter::modifier(9));\r\n    }\r\n\r\n    /**\r\n     * uuid 6f4e6c88-1cd9-46a0-92b8-db4a99b372f7\r\n     */\r\n    #[TestDox('Ability modifier - ability modifier for score 10 is 0')]\r\n    public function testAbilityModifierFor10Is0()\r\n    {\r\n        $this->assertEquals(0, DndCharacter::modifier(10));\r\n    }\r\n\r\n    /**\r\n     * uuid e00d9e5c-63c8-413f-879d-cd9be9697097\r\n     */\r\n    #[TestDox('Ability modifier - ability modifier for score 11 is 0')]\r\n    public function testAbilityModifierFor11Is0()\r\n    {\r\n        $this->assertEquals(0, DndCharacter::modifier(11));\r\n    }\r\n\r\n    /**\r\n     * uuid eea06f3c-8de0-45e7-9d9d-b8cab4179715\r\n     */\r\n    #[TestDox('Ability modifier - ability modifier for score 12 is +1')]\r\n    public function testAbilityModifierFor12Is1()\r\n    {\r\n        $this->assertEquals(1, DndCharacter::modifier(12));\r\n    }\r\n\r\n    /**\r\n     * uuid 9c51f6be-db72-4af7-92ac-b293a02c0dcd\r\n     */\r\n    #[TestDox('Ability modifier - ability modifier for score 13 is +1')]\r\n    public function testAbilityModifierFor13Is1()\r\n    {\r\n        $this->assertEquals(1, DndCharacter::modifier(13));\r\n    }\r\n\r\n    /**\r\n     * uuid 94053a5d-53b6-4efc-b669-a8b5098f7762\r\n     */\r\n    #[TestDox('Ability modifier - ability modifier for score 14 is +2')]\r\n    public function testAbilityModifierFor14Is2()\r\n    {\r\n        $this->assertEquals(2, DndCharacter::modifier(14));\r\n    }\r\n\r\n    /**\r\n     * uuid 8c33e7ca-3f9f-4820-8ab3-65f2c9e2f0e2\r\n     */\r\n    #[TestDox('Ability modifier - ability modifier for score 15 is +2')]\r\n    public function testAbilityModifierFor15Is2()\r\n    {\r\n        $this->assertEquals(2, DndCharacter::modifier(15));\r\n    }\r\n\r\n    /**\r\n     * uuid c3ec871e-1791-44d0-b3cc-77e5fb4cd33d\r\n     */\r\n    #[TestDox('Ability modifier - ability modifier for score 16 is +3')]\r\n    public function testAbilityModifierFor16Is3()\r\n    {\r\n        $this->assertEquals(3, DndCharacter::modifier(16));\r\n    }\r\n\r\n    /**\r\n     * uuid 3d053cee-2888-4616-b9fd-602a3b1efff4\r\n     */\r\n    #[TestDox('Ability modifier - ability modifier for score 17 is +3')]\r\n    public function testAbilityModifierFor17Is3()\r\n    {\r\n        $this->assertEquals(3, DndCharacter::modifier(17));\r\n    }\r\n\r\n    /**\r\n     * uuid bafd997a-e852-4e56-9f65-14b60261faee\r\n     */\r\n    #[TestDox('Ability modifier - ability modifier for score 18 is +4')]\r\n    public function testAbilityModifierFor18is4()\r\n    {\r\n        $this->assertEquals(4, DndCharacter::modifier(18));\r\n    }\r\n\r\n    /**\r\n     * uuid 4f28f19c-2e47-4453-a46a-c0d365259c14\r\n     */\r\n    #[TestDox('Random ability is within range')]\r\n    public function testRandomAbilityIsInRange()\r\n    {\r\n        for ($i = 0; $i < 10; $i++) {\r\n            $ability = DndCharacter::ability();\r\n            $this->assertInRange($ability, 3, 18);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * uuid 385d7e72-864f-4e88-8279-81a7d75b04ad\r\n     */\r\n    #[TestDox('Random character is valid')]\r\n    public function testRandomCharacterIsValid()\r\n    {\r\n        for ($i = 0; $i < 10; $i++) {\r\n            $character = DndCharacter::generate();\r\n            $this->assertInRange($character->strength, 3, 18, 'strength');\r\n            $this->assertInRange($character->dexterity, 3, 18, 'dexterity');\r\n            $this->assertInRange($character->constitution, 3, 18, 'constitution');\r\n            $this->assertInRange($character->intelligence, 3, 18, 'intelligence');\r\n            $this->assertInRange($character->wisdom, 3, 18, 'wisdom');\r\n            $this->assertInRange($character->charisma, 3, 18, 'charisma');\r\n\r\n            $expectedHitpoints = 10 + DndCharacter::modifier($character->constitution);\r\n            $this->assertEquals(\r\n                $expectedHitpoints,\r\n                $character->hitpoints,\r\n                'The calculated hitpoints value ' . $character->hitpoints\r\n                    . ' is not ' . $expectedHitpoints . '.',\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * uuid dca2b2ec-f729-4551-84b9-078876bb4808\r\n     */\r\n    #[TestDox('Each ability is only calculated once')]\r\n    public function testEachAbilityIsCalculatedOnce()\r\n    {\r\n        for ($i = 0; $i < 10; $i++) {\r\n            $character = DndCharacter::generate();\r\n            $this->assertDoesNotChange($character->strength, $character->strength, 'strength');\r\n            $this->assertDoesNotChange($character->dexterity, $character->dexterity, 'dexterity');\r\n            $this->assertDoesNotChange($character->constitution, $character->constitution, 'constitution');\r\n            $this->assertDoesNotChange($character->intelligence, $character->intelligence, 'intelligence');\r\n            $this->assertDoesNotChange($character->wisdom, $character->wisdom, 'wisdom');\r\n            $this->assertDoesNotChange($character->charisma, $character->charisma, 'charisma');\r\n        }\r\n    }\r\n\r\n    private function assertInRange(int $value, int $start, int $end, string $valueName = ''): void\r\n    {\r\n        $this->assertThat(\r\n            $value,\r\n            $this->logicalAnd(\r\n                $this->greaterThanOrEqual($start),\r\n                $this->lessThanOrEqual($end)\r\n            ),\r\n            'The calculated'\r\n                . (empty($valueName) ? '' : (' ' . $valueName))\r\n                . ' value ' . $value\r\n                . ' is not between ' . $start . ' and ' . $end . '.',\r\n        );\r\n    }\r\n\r\n    private function assertDoesNotChange(\r\n        int $valueFirstAccess,\r\n        int $valueSecondAccess,\r\n        string $valueName = ''\r\n    ): void {\r\n        $this->assertEquals(\r\n            $valueFirstAccess,\r\n            $valueSecondAccess,\r\n            'The'\r\n                . (empty($valueName) ? '' : (' ' . $valueName))\r\n                . ' value changed from ' . $valueFirstAccess\r\n                . ' to ' . $valueSecondAccess\r\n                . ' when accessed a second time.',\r\n        );\r\n    }\r\n}\r\n"
  }
}