{
  "language": "csharp",
  "slug": "faceid-2",
  "docs": {
    "introduction": "# Introduction\r\n\r\n## Equality\r\n\r\nSimple types (strings and primitives) are typically tested for equality with the `==` and `!=`.\r\n\r\nReference types (Instances of classes) are compared using the `Equals()` method inherited from `Object`. If your goal with the equality test is to ensure that two objects are the exact same instance then relying on `Object`'s implementation will suffice. If not, you need to override `object.Equals()`.\r\n\r\nIf you know that all the instances of your class are created in one place, say characters in some game or simulation then reference equality is sufficient. However, it is likely that multiple instances of the same real-world entity will be created (from a database, by user input, via a web request). In this case values that uniquely identify the entity must be tested for equality. Therefore `Equals()` must be overridden and appropriate data members of your class are tested for equality.\r\n\r\nAn overridden `Equals()` method will contain equality tests on members of simple types using `==` and reference types with recursive calls to `Equals()`.\r\n\r\nThe `Object` class provides appropriate methods to compare two objects to detect if they are one and the same instance.\r\n\r\n### `Object.GetHashCode()`\r\n\r\nThe `Object.GetHashCode()` method returns a hash code in the form of a 32 bit integer. The hash code is used by _dictionary_ and _set_ classes such as `Dictionary<T>` and `HashSet<T>`to store and retrieve objects in a performant manner.\r\n\r\nThe relationship between hash code and equality is that if two objects are equal (`Equal()` returns true) then `GetHashCode()` for the two objects must return the same value. This does not apply in the reverse direction. It is not symmetrical. Just because two objects have the same hashcode they do not have to be equal. Picture a lookup function that first goes to a \"bucket\" based on the hash code and then picks out the particular item using the equality test.\r\n\r\nThe HashCode library API documentation discusses the best way to generate a hash code\r\n\r\nThe values used in the equality test must be stable while the hashed collection is in use. If you add an object to the collection with one set of values and then change those values the hash code will no longer point to the correct \"bucket\". In practice this means that the object should be immutable. Other approaches run the risk of creating gotchas for maintainers.\r\n\r\n## Sets\r\n\r\nA set is a collection of unique values. The default .NET implementation of a set is the `HashSet<T>` class, which is a collection that only contains unique values.\r\n",
    "instructions": "# Instructions\r\n\r\nYou are working on a system to simplify the login process for your organization's network. The tasks concern the authentication part. The system uses facial recognition to prove identity.\r\n\r\nIn all occurrences the eye color parameter is guaranteed to be non-null.\r\n\r\n## 1. Ensure that facial features match\r\n\r\nImplement `Authenticator.AreSameFace()` to check that two faces match.\r\n\r\nAdd equality routines for the `FacialFeatures` class.\r\n\r\n```csharp\r\nAuthenticator.AreSameFace(new FacialFeatures(\"green\", 0.9m), new FacialFeatures(\"green\", 0.9m);\r\n// => true\r\nAuthenticator.AreSameFace(new FacialFeatures(\"blue\", 0.9m), new FacialFeatures(\"green\", 0.9m);\r\n// => false\r\n```\r\n\r\n## 2. Authenticate the system administrator\r\n\r\nDespite your protests the system administrator insists on having a built-in identity during acceptance testing so that they can always be authenticated.\r\n\r\nThe admin's email is admin@exerc.ism. They have green eyes and a philtrum with a width of 0.9.\r\n\r\nAdd equality routines for the `Identity` class.\r\n\r\nImplement the `Authenticator.IsAdmin()` method to check that the identity passed in matches that of the administrator.\r\n\r\n```csharp\r\nvar authenticator = new Authenticator();\r\nauthenticator.IsAdmin(new Identity(\"admin@exerc.ism\", new FacialFeatures(\"green\", 0.9m)));\r\n// => true\r\nauthenticator.IsAdmin(new Identity(\"admin@thecompetition.com\", new FacialFeatures(\"green\", 0.9m)));\r\n// => false\r\n```\r\n\r\n## 3. Register new identities\r\n\r\nImplement the `Authenticator.Register()` method which stores an identity on the authenticator itself such that calls to `IsRegistered()` will return `true` for this identity: otherwise `IsRegistered()` returns `false`.\r\n\r\nTo detect duplicated attempts to register an identity, if the identity has already been registered then `false` is returned by `Authenticator.Register()`, otherwise `true`.\r\n\r\n```csharp\r\nvar authenticator = new Authenticator();\r\nauthenticator.Register(new Identity(\"tunde@thecompetition.com\", new FacialFeatures(\"blue\", 0.9m)));\r\n// => true\r\nauthenticator.IsRegistered(new Identity(\"tunde@thecompetition.com\", new FacialFeatures(\"blue\", 0.9m)));\r\n// => true\r\nauthenticator.Register(new Identity(\"tunde@thecompetition.com\", new FacialFeatures(\"blue\", 0.9m)));\r\n// => false\r\n```\r\n\r\n## 4. Prevent invalid identities being authenticated\r\n\r\nImplement the `Authenticator.IsRegistered()` method and ensure it returns false when no identities have been registered.\r\n\r\n```csharp\r\nvar authenticator = new Authenticator();\r\nauthenticator.IsRegistered(new Identity(\"alice@thecompetition.com\", new FacialFeatures(\"blue\", 0.8m)));\r\n// => false\r\n```\r\n\r\n## 5. Add diagnostics to detect multiple attempts to authenticate\r\n\r\nA bug has been reported whereby the `Authenticator.IsRegistered()` method is called multiple times in quick succession for the same identity. You believe that there is some sort of \"bounce\" problem where the exact same record is being submitted multiple times. Your task is to add a diagnostic routine `Authenticator.AreSameObject()` to support any testing that's undertaken. The routine compares to objects and returns `true` if they are the exact same instance otherwise `false`.\r\n\r\n```csharp\r\nvar identityA = new Identity(\"alice@thecompetition.com\", new FacialFeatures(\"blue\", 0.9m));\r\nvar identityB = identityA;\r\nAuthenticator.AreSameObject(identityA, identityB);\r\n// => true\r\n\r\nvar identityC = new Identity(\"alice@thecompetition.com\", new FacialFeatures(\"blue\", 0.9m));\r\nvar identityD = new Identity(\"alice@thecompetition.com\", new FacialFeatures(\"blue\", 0.9m));\r\nAuthenticator.AreSameObject(identityC, identityD);\r\n// => false\r\n```\r\n",
    "hints": "# Hints\r\n\r\n## General\r\n\r\n- [Equality][equality]: how equality comparisons work in C#, including reference- and value type equality.\r\n- [HashCode][hash-code]: how to create and combine hash codes\r\n- [GetHashCode][get-hash-code]: API documentation\r\n- [HashSet][hash-set]: API documentation\r\n\r\n## 1. Ensure that facial features match\r\n\r\nComparing reference types by value is discussed in detail in this [article][value-equality].\r\n\r\n## 2. Authenticate the system administrator\r\n\r\nThis is simply a case of applying the lessons learnt in task 1 in a trivially recursive manner.\r\n\r\n## 3. Register new identities\r\n\r\nThe most performant, and \"natural\", way to handle a collection of unique values is by using a [hash set][hash-set]. If you encounter issues with the tests passing locally but failing on the website, try using instance members rather than `static` members in the `Authenticator` class.\r\n\r\n## 4. Prevent invalid identities being authenticated\r\n\r\nConsider the [`HashSet<T>.Contains()`][hash-set-contains] method. If you encounter issues with the tests passing locally but failing on the website, try using instance members rather than `static` members in the `Authenticator` class.\r\n\r\n## 5. Add diagnostics to detect multiple attempts to authenticate\r\n\r\nThis [documentation][reference-equality] addresses the issue of comparing instances as opposed to values.\r\n\r\n[equality]: https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/statements-expressions-operators/equality-comparisons\r\n[hash-set]: https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.hashset-1\r\n[hash-code]: https://docs.microsoft.com/en-us/dotnet/api/system.hashcode\r\n[get-hash-code]: https://docs.microsoft.com/en-us/dotnet/api/system.object.gethashcode\r\n[reference-equality]: https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/statements-expressions-operators/equality-comparisons#reference-equality\r\n[value-equality]: https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/statements-expressions-operators/how-to-define-value-equality-for-a-type\r\n[hash-set-contains]: https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.hashset-1.contains\r\n[exercism-test-runner]: https://exercism.org/docs/building/tooling/test-runners\r\n"
  },
  "starter_code": {
    "Faceid2.cs": "public class FacialFeatures\r\n{\r\n    public string EyeColor { get; }\r\n    public decimal PhiltrumWidth { get; }\r\n\r\n    public FacialFeatures(string eyeColor, decimal philtrumWidth)\r\n    {\r\n        EyeColor = eyeColor;\r\n        PhiltrumWidth = philtrumWidth;\r\n    }\r\n    // TODO: implement equality and GetHashCode() methods\r\n}\r\n\r\npublic class Identity\r\n{\r\n    public string Email { get; }\r\n    public FacialFeatures FacialFeatures { get; }\r\n\r\n    public Identity(string email, FacialFeatures facialFeatures)\r\n    {\r\n        Email = email;\r\n        FacialFeatures = facialFeatures;\r\n    }\r\n    // TODO: implement equality and GetHashCode() methods\r\n}\r\n\r\npublic class Authenticator\r\n{\r\n    public static bool AreSameFace(FacialFeatures faceA, FacialFeatures faceB)\r\n    {\r\n        throw new NotImplementedException(\"Please implement the (static) Authenticator.AreSameFace() method\");\r\n    }\r\n\r\n    public bool IsAdmin(Identity identity)\r\n    {\r\n        throw new NotImplementedException(\"Please implement the Authenticator.IsAdmin() method\");\r\n    }\r\n\r\n    public bool Register(Identity identity)\r\n    {\r\n        throw new NotImplementedException(\"Please implement the Authenticator.Register() method\");\r\n    }\r\n\r\n    public bool IsRegistered(Identity identity)\r\n    {\r\n        throw new NotImplementedException(\"Please implement the Authenticator.IsRegistered() method\");\r\n    }\r\n\r\n    public static bool AreSameObject(Identity identityA, Identity identityB)\r\n    {\r\n        throw new NotImplementedException(\"Please implement the Authenticator.AreSameObject() method\");\r\n    }\r\n}\r\n"
  },
  "tests": {
    "Faceid2Tests.cs": "using Exercism.Tests;\r\n\r\npublic class Faceid2Tests\r\n{\r\n    [Fact]\r\n    [Task(1)]\r\n    public void AreSameFace_yes()\r\n    {\r\n        Assert.True(Authenticator.AreSameFace(new FacialFeatures(\"green\", 0.9m),\r\n            new FacialFeatures(\"green\", 0.9m)));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(1)]\r\n    public void AreSameFace_no()\r\n    {\r\n        Assert.False(Authenticator.AreSameFace(new FacialFeatures(\"green\", 0.9m),\r\n            new FacialFeatures(\"blue\", 0.9m)));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(2)]\r\n    public void IsAdmin_with_admin()\r\n    {\r\n        var authenticator = new Authenticator();\r\n        Assert.True(authenticator.IsAdmin(new Identity(\"admin@exerc.ism\", new FacialFeatures(\"green\", 0.9m))));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(2)]\r\n    public void IsAdmin_with_wrong_email()\r\n    {\r\n        var authenticator = new Authenticator();\r\n        Assert.False(authenticator.IsAdmin(new Identity(\"admin@thecompetition.com\", new FacialFeatures(\"green\", 0.9m))));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(2)]\r\n    public void IsAdmin_with_wrong_face()\r\n    {\r\n        var authenticator = new Authenticator();\r\n        Assert.False(authenticator.IsAdmin(new Identity(\"admin@exerc.ism\", new FacialFeatures(\"blue\", 0.9m))));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(3)]\r\n    public void Register_new_identity()\r\n    {\r\n        var authenticator = new Authenticator();\r\n        Assert.True(authenticator.Register(new Identity(\"alice@thecompetition.com\", new FacialFeatures(\"blue\", 0.9m))));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(3)]\r\n    public void Register_existing_identity()\r\n    {\r\n        var authenticator = new Authenticator();\r\n        authenticator.Register(new Identity(\"tunde@thecompetition.com\", new FacialFeatures(\"blue\", 0.9m)));\r\n        Assert.False(authenticator.Register(new Identity(\"tunde@thecompetition.com\", new FacialFeatures(\"blue\", 0.9m))));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(3)]\r\n    public void IsRegistered_existing_identity()\r\n    {\r\n        var authenticator = new Authenticator();\r\n        authenticator.Register(new Identity(\"alice@thecompetition.com\", new FacialFeatures(\"blue\", 0.9m)));\r\n        Assert.True(authenticator.IsRegistered(new Identity(\"alice@thecompetition.com\", new FacialFeatures(\"blue\", 0.9m))));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(4)]\r\n    public void IsRegistered_non_existent_identity()\r\n    {\r\n        var authenticator = new Authenticator();\r\n        authenticator.Register(new Identity(\"alice@thecompetition.com\", new FacialFeatures(\"blue\", 0.9m)));\r\n        Assert.False(authenticator.IsRegistered(new Identity(\"alice@thecompetition.com\", new FacialFeatures(\"blue\", 0.8m))));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(5)]\r\n    public void AreSameObject_same_objects()\r\n    {\r\n        var identityA = new Identity(\"alice@thecompetition.com\", new FacialFeatures(\"blue\", 0.9m));\r\n        Assert.True(Authenticator.AreSameObject(identityA, identityA));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(5)]\r\n    public void AreSameObject_different_objects()\r\n    {\r\n        var identityA = new Identity(\"alice@thecompetition.com\", new FacialFeatures(\"blue\", 0.9m));\r\n        var identityB = new Identity(\"alice@thecompetition.com\", new FacialFeatures(\"blue\", 0.9m));\r\n        Assert.False(Authenticator.AreSameObject(identityA, identityB));\r\n    }\r\n\r\n}\r\n"
  }
}