{
  "language": "csharp",
  "slug": "parsing-log-files",
  "docs": {
    "introduction": "# Introduction\r\n\r\n## Regular Expressions\r\n\r\nThe .NET base class libraries provide the `Regex` class for processing of regular expressions.\r\n",
    "instructions": "# Instructions\r\n\r\nThis exercise addresses the parsing of log files.\r\n\r\nAfter a recent security review you have been asked to clean up the organization's archived log files.\r\n\r\nAll strings passed to the methods are guaranteed to be non-null and without leading and trailing spaces.\r\n\r\n## 1. Identify garbled log lines\r\n\r\nYou need some idea of how many log lines in your archive do not comply with current standards. You believe that a simple test reveals whether a log line is valid. To be considered valid a line should begin with one of the following strings:\r\n\r\n- [TRC]\r\n- [DBG]\r\n- [INF]\r\n- [WRN]\r\n- [ERR]\r\n- [FTL]\r\n\r\nImplement the `LogParser.IsValidLine()` method to return `false` if a string is not valid otherwise `true`.\r\n\r\n```csharp\r\nvar lp = new LogParser();\r\nlp.IsValidLine(\"[ERR] A good error here\");\r\n// => true\r\nlp.IsValidLine(\"Any old [ERR] text\");\r\n// => false\r\nlp.IsValidLine(\"[BOB] Any old text\");\r\n// => false\r\n```\r\n\r\n## 2. Split the log line\r\n\r\nA new team has joined the organization, and you find their log files are using a strange separator for \"fields\". Instead of something sensible like a colon \":\" they use a string such as \"<--->\" or \"<=>\" (because it's prettier) in fact any string that has a first character of \"<\" and a last character of \">\" and any combination of the following characters \"^\", \"\\*\", \"=\" and \"-\" in between.\r\n\r\nImplement the `LogParser.SplitLogLine()` method that takes a line and returns an array of strings each of which contains a field.\r\n\r\n```csharp\r\nvar lp = new LogParser();\r\nlp.SplitLogLine(\"Section 1<===>Section 2<^-^>Section 3\");\r\n// => {\"Section 1\", \"Section 2\", \"Section 3\"}\r\n```\r\n\r\n## 3. Count the number of lines containing a quoted password\r\n\r\nThe team needs to know about passwords occurring in quoted text so that they can be examined manually.\r\n\r\nImplement the `LogParser.CountQuotedPasswords()` method to provide an indication of the likely scale of the manual exercise.\r\n\r\nIdentify log lines where the literal string \"password\", which may be in any combination of upper or lower case, is surrounded by quotation marks.\r\nYou should account for the possibility of additional content between the quotation marks before and after \"password\".\r\n\r\nLines passed to the routine may or may not be valid as defined in task 1. We process them in the same way, whether or not they are valid.\r\n\r\n```csharp\r\nstring lines =\r\n    \"[INF] passWord \" + Environment.NewLine + // contains 'password' but not surrounded by quotation marks\r\n    \"\\\"passWord\\\"\" + Environment.NewLine + // count this one\r\n    \"[INF] User saw error message \\\"Unexpected Error\\\" on page load.\" + Environment.NewLine + //does not contain 'password'\r\n    \"[INF] \\\"The secret password was added by the user\\\"\"; // count this one\r\n\r\nvar lp = new LogParser();\r\nlp.CountQuotedPasswords(lines);\r\n// => 2\r\n```\r\n\r\n## 4. Remove artifacts from log\r\n\r\nYou have found that some upstream processing of the logs has been scattering the text \"end-of-line\" followed by a line number (without an intervening space) throughout the logs.\r\n\r\nImplement the `LogParser.RemoveEndOfLineText()` method to take a string and remove the end-of-line text and return a \"clean\" string.\r\n\r\nLines not containing end-of-line text should be returned unmodified.\r\n\r\nJust remove the end of line string. Do not attempt to adjust the whitespaces.\r\n\r\n```csharp\r\nvar lp = new LogParser();\r\nlp.RemoveEndOfLineText(\"[INF] end-of-line23033 Network Failure end-of-line27\");\r\n// => \"[INF]  Network Failure \"\r\n```\r\n\r\n## 5. List lines with extremely weak passwords so the guilty can be punished\r\n\r\nBefore expunging the passwords from the file we need to list any instances where passwords begin with the text \"password\".\r\n\r\nImplement the `LogParser.ListLinesWithPasswords()` method to print out the offending password followed by the complete line.\r\n\r\nLines with quoted passwords have already been removed and you process lines irrespective of whether they are valid (as per task 1).\r\n\r\nLines containing an offending password should be returned prefixed with \"<password>: \".\r\n\r\nLines not containing an offending password should be returned prefixed with \"--------: \".\r\n\r\n```csharp\r\nvar lp = new LogParser();\r\nlp.ListLinesWithPasswords(new string[] {\"my passwordsecret is great\"});\r\n// => \"passwordsecret: my passwordsecret is great\"\r\nlp.ListLinesWithPasswords(new string[] {\"my password secret\"});\r\n// => {\"--------: my password secret\"}\r\n\r\n```\r\n",
    "hints": "# General\r\n\r\n- [regular expressions][regular-expressions] documentation describes regexes and the flavour built into the .NET libraries.\r\n- [Regex][regex] documentation describing the built-in library class.\r\n\r\n## 1. Identify garbled log lines\r\n\r\n- See [this discussion][ismatch] of matching.\r\n\r\n## 2. Split the log line\r\n\r\n- [This][split] article shows an approach to splitting lines.\r\n\r\n## 3. Count the number of lines containing a password\r\n\r\n- See [this discussion][multiple-matches] of multiple matches and [this][multi-line] on multi-line searches.\r\n\r\n## 4. Remove artifacts from log\r\n\r\n- [This article][replace] shows how text can be replaced.\r\n\r\n## 5. List lines with extremely weak passwords so the guilty can be punished\r\n\r\n- Capture groups are discussed [here][capture-groups].\r\n\r\n[regular-expressions]: https://docs.microsoft.com/en-us/dotnet/standard/base-types/regular-expression-language-quick-reference\r\n[regex]: https://docs.microsoft.com/en-us/dotnet/api/system.text.regularexpressions.regex\r\n[ismatch]: https://docs.microsoft.com/en-us/dotnet/api/system.text.regularexpressions.regex.ismatch\r\n[split]: https://docs.microsoft.com/en-us/dotnet/api/system.text.regularexpressions.regex.split\r\n[multiple-matches]: https://docs.microsoft.com/en-us/dotnet/api/system.text.regularexpressions.regex.matches\r\n[multi-line]: https://docs.microsoft.com/en-us/dotnet/api/system.text.regularexpressions.regexoptions\r\n[replace]: https://docs.microsoft.com/en-us/dotnet/api/system.text.regularexpressions.regex.replace\r\n[capture-groups]: https://docs.microsoft.com/en-us/dotnet/standard/base-types/grouping-constructs-in-regular-expressions\r\n"
  },
  "starter_code": {
    "ParsingLogFiles.cs": "public class LogParser\r\n{\r\n    public bool IsValidLine(string text)\r\n    {\r\n        throw new NotImplementedException($\"Please implement the LogParser.IsValidLine() method\");\r\n    }\r\n\r\n    public string[] SplitLogLine(string text)\r\n    {\r\n        throw new NotImplementedException($\"Please implement the LogParser.SplitLogLine() method\");\r\n    }\r\n\r\n    public int CountQuotedPasswords(string lines)\r\n    {\r\n        throw new NotImplementedException($\"Please implement the LogParser.CountQuotedPasswords() method\");\r\n    }\r\n\r\n    public string RemoveEndOfLineText(string line)\r\n    {\r\n        throw new NotImplementedException($\"Please implement the LogParser.RemoveEndOfLineText() method\");\r\n    }\r\n\r\n    public string[] ListLinesWithPasswords(string[] lines)\r\n    {\r\n        throw new NotImplementedException($\"Please implement the LogParser.ListLinesWithPasswords() method\");\r\n    }\r\n}\r\n"
  },
  "tests": {
    "ParsingLogFilesTests.cs": "using Exercism.Tests;\r\n\r\npublic class ParsingLogFilesTests\r\n{\r\n    [Fact]\r\n    [Task(1)]\r\n    public void IsValidLine_match()\r\n    {\r\n        var lp = new LogParser();\r\n        Assert.True(lp.IsValidLine(\"[INF] My Message\"));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(1)]\r\n    public void IsValidLine_no_match()\r\n    {\r\n        var lp = new LogParser();\r\n        Assert.False(lp.IsValidLine(\"bad start to [INF] Message\"));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(2)]\r\n    public void SplitLogLine()\r\n    {\r\n        var lp = new LogParser();\r\n        Assert.Equal(new string[] { \"section 1\", \"section 2\", \"section 3\" }, lp.SplitLogLine(\"section 1<^>section 2<--->section 3\"));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(2)]\r\n    public void SplitLogLine_Empty()\r\n    {\r\n        var lp = new LogParser();\r\n        Assert.Equal(new string[] { string.Empty }, lp.SplitLogLine(string.Empty));\r\n    }\r\n\r\n\r\n    [Fact]\r\n    [Task(3)]\r\n    public void AreQuotedPasswords()\r\n    {\r\n        var lp = new LogParser();\r\n        string[] lines =\r\n        {\r\n            string.Empty,\r\n            \"[INF] passWord\",\r\n            \"\\\"passWord\\\"\",\r\n            \"[INF] User saw error message \\\"Unexpected Error\\\" on page load.\",\r\n            \"[INF] The message \\\"Please reset your password\\\" was ignored by the user\"\r\n        };\r\n        Assert.Equal(2, lp.CountQuotedPasswords(string.Join(Environment.NewLine, lines)));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(4)]\r\n    public void RemoveEndOfLineText()\r\n    {\r\n        var lp = new LogParser();\r\n        string input = \"[INF] end-of-line23033 Network Falure end-of-line27\";\r\n        Assert.Equal(\"[INF]  Network Falure \", lp.RemoveEndOfLineText(input));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(5)]\r\n    public void ListLinesWithPasswords()\r\n    {\r\n        var lp = new LogParser();\r\n        string[] lines =\r\n        {\r\n            \"[INF] passWordaa\",\r\n            \"passWord mysecret\",\r\n            \"[INF] password KeyToTheCastle for nobody\",\r\n            \"[INF] password password123 for everybody\"\r\n        };\r\n        string[] expected =\r\n        {\r\n            \"passWordaa: [INF] passWordaa\",\r\n            \"--------: passWord mysecret\",\r\n            \"--------: [INF] password KeyToTheCastle for nobody\",\r\n            \"password123: [INF] password password123 for everybody\"\r\n        };\r\n        Assert.Equal(expected, lp.ListLinesWithPasswords(lines));\r\n    }\r\n}\r\n"
  }
}