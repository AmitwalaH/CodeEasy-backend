{
  "language": "csharp",
  "slug": "instruments-of-texas",
  "docs": {
    "introduction": "# Introduction\r\n\r\n## Exception Filtering\r\n\r\n`when` is the keyword in filtering exceptions. It is placed after the catch\r\nstatement and can take a Boolean expression containing any values in scope at the time. If the expression evaluates to true then the block associated with that `catch` statement is executed otherwise the next `catch` statement, if any, is checked.\r\n\r\n```csharp\r\ntry\r\n{\r\n    // do stuff\r\n}\r\ncatch (Exception ex) when (ex.Message != \"\")\r\n{\r\n    // output the message when it is not empty\r\n}\r\ncatch (Exception ex)\r\n{\r\n    // show stack trace or something.\r\n}\r\n```\r\n\r\n## User Defined Exceptions\r\n\r\nA user-defined exception is any class defined in your code that is derived from `System.Exception`. It is subject to all the rules of class inheritance but in addition the compiler and language runtime treat such classes in a special way allowing their instances to be thrown and caught outside the normal control flow as discussed in the `exceptions` exercise.\r\n\r\nUser-defined exceptions are often used to carry extra information such as a message and other relevant data to be made available to the catching routines.\r\n",
    "instructions": "# Instructions\r\n\r\nWhile working at _Instruments of Texas_, you are tasked to work on an experimental calculator written in C#. You are building a test harness to verify a number of calculator functions starting with multiplication. You will see that there is particular concern when the two operands of the multiplication are negative.\r\n\r\nThe `Calculator` class has been provided for you and should not be modified.\r\n\r\n## 1. Complete the definition of the user-defined exception `CalculationException`\r\n\r\nComplete the definition of the constructor of `CalculationException` which will need to store (wrap) any exception thrown by the calculator as well as the operands that are being processed at the time the exception is thrown.\r\n\r\n## 2. Handle overflow conditions in the calculator and provide enhanced information to the caller\r\n\r\nImplement the `CalculatorTestHarness.Multiply()` method, which should call the `Calculator.Multiply()` method of the `Calculator` instance passed to the constructor.\r\npassing in x and y integer values. If an overflow occurs in the `Calculator.Multiply()` method, it will throw an `OverflowException`. This exception should be caught in the `CalculatorTestHarness.Multiply()` method and wrapped in a `CalculationException` and the x and y values being passed around should be stored as the exception's operands. The newly created `CalculationException` object should be thrown. You can ignore the value returned by the `Calculator.Multiply()` method if it is successful.\r\n\r\n```csharp\r\nvar cth = new CalculatorTestHarness(new Calculator());\r\ncth.Multiply(Int32.MaxValue, Int32.MaxValue);\r\n// => throws an instance of CalculationException\r\n\r\nvar cth2 = new CalculatorTestHarness(new Calculator());\r\ncth2.Multiply(3, 2);\r\n// => silently exits\r\n```\r\n\r\n## 3. Test the multiplication operation for valid inputs\r\n\r\nImplement the `CalculatorTestHarness.TestMultiplication()` method which takes two integers and calls the `CalculatorTestHarness.Multiply()` method. `\"Multiply succeeded\"` is returned.\r\n\r\n```csharp\r\nvar cth = new CalculatorTestHarness(new Calculator());\r\ncth.TestMultiplication(6, 7);\r\n// => \"Multiply succeeded\"\r\n```\r\n\r\n## 4. Test the multiplication operation for negative inputs\r\n\r\nModify the `CalculatorTestHarness.TestMultiplication()` method so that `\"Multiply failed for negative operands. <INNER_EXCEPTION_MESSAGE>\"`is returned if both integer arguments are negative (less than zero).\r\n\r\nThe `<INNER_EXCEPTION_MESSAGE>` placeholder should be replaced with the `CalculationException`'s inner exception's message.\r\n\r\n```csharp\r\nvar cth = new CalculatorTestHarness(new Calculator());\r\ncth.TestMultiplication(-2, -Int32.MaxValue);\r\n// => \"Multiply failed for negative operands. \" + innerException.Message\r\n```\r\n\r\n## 5. Test the multiplication operation for positive inputs\r\n\r\nModify the `CalculatorTestHarness.TestMultiplication()` method so that `\"Multiply failed for mixed or positive operands. <INNER_EXCEPTION_MESSAGE>\"` is returned if at least one of the integer arguments is not negative.\r\n\r\nThe `<INNER_EXCEPTION_MESSAGE>` placeholder should be replaced with the `CalculationException`'s inner exception's message.\r\n\r\n```csharp\r\nvar cth = new CalculatorTestHarness(new Calculator());\r\ncth.TestMultiplication(Int32.MaxValue, Int32.MaxValue);\r\n// => \"Multiply failed for mixed or positive operands. \" + innerException.Message\r\n```\r\n",
    "hints": "# Hints\r\n\r\n## General\r\n\r\n- [Create user-defined exceptions][create-user-defined-exceptions]: how to create user-defined exceptions\r\n- [Exception filters][exception-filters]: how to filter user-defined-exceptions.\r\n\r\n## 1. Complete the definition of the user-defined exception `CalculationException`\r\n\r\n- The constructors of the `Exception` base class are discussed [here][exception-constructors].\r\n\r\n## 2. Implement the `Multiply()` method\r\n\r\n- `try-catch` blocks are discussed [here][try-catch] as well as in the `exceptions` exercise.\r\n\r\n## 4. Implement the `TestMultiplication()` method\r\n\r\n- This [article][try-catch-when] has an example of the use of `when`.\r\n\r\n[create-user-defined-exceptions]: https://docs.microsoft.com/en-us/dotnet/standard/exceptions/how-to-create-user-defined-exceptions\r\n[exception-filters]: https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/when\r\n[exception-constructors]: https://docs.microsoft.com/en-us/dotnet/api/system.exception.-ctor\r\n[try-catch]: https://docs.microsoft.com/en-us/dotnet/standard/exceptions/how-to-use-the-try-catch-block-to-catch-exceptions\r\n[try-catch-when]: https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/try-catch\r\n"
  },
  "starter_code": {
    "InstrumentsOfTexas.cs": "public class CalculationException : Exception\r\n{\r\n    public CalculationException(int operand1, int operand2, string message, Exception inner)\r\n    // TODO: complete the definition of the constructor\r\n    {\r\n    }\r\n\r\n    public int Operand1 { get; }\r\n    public int Operand2 { get; }\r\n}\r\n\r\npublic class CalculatorTestHarness\r\n{\r\n    private Calculator calculator;\r\n\r\n    public CalculatorTestHarness(Calculator calculator)\r\n    {\r\n        this.calculator = calculator;\r\n    }\r\n\r\n    public string TestMultiplication(int x, int y)\r\n    {\r\n        throw new NotImplementedException(\"Please implement the CalculatorTestHarness.TestMultiplication() method\");\r\n    }\r\n\r\n    public void Multiply(int x, int y)\r\n    {\r\n        throw new NotImplementedException(\"Please implement the CalculatorTestHarness.Multiply() method\");\r\n    }\r\n}\r\n\r\n\r\n// Please do not modify the code below.\r\n// If there is an overflow in the multiplication operation\r\n// then a System.OverflowException is thrown.\r\npublic class Calculator\r\n{\r\n    public int Multiply(int x, int y)\r\n    {\r\n        checked\r\n        {\r\n            return x * y;\r\n        }\r\n    }\r\n}\r\n"
  },
  "tests": {
    "InstrumentsOfTexasTests.cs": "using Exercism.Tests;\r\n\r\npublic class InstrumentsOfTexasTests\r\n{\r\n    [Fact]\r\n    [Task(2)]\r\n    public void Multiply_with_overflow_throws_calculationexception()\r\n    {\r\n        var cth = new CalculatorTestHarness(new Calculator());\r\n\r\n        Assert.Throws<CalculationException>(() => cth.Multiply(Int32.MaxValue, Int32.MaxValue));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(3)]\r\n    public void Call_TestMultiplication_with_success()\r\n    {\r\n        var cth = new CalculatorTestHarness(new Calculator());\r\n        Assert.Equal(\"Multiply succeeded\", cth.TestMultiplication(6, 7));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(4)]\r\n    public void TestMultiplication_with_negative_overflow()\r\n    {\r\n        var cth = new CalculatorTestHarness(new Calculator());\r\n        Assert.Equal(\"Multiply failed for negative operands. Arithmetic operation resulted in an overflow.\",\r\n            cth.TestMultiplication(-2, -Int32.MaxValue));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(5)]\r\n    public void TestMultiplication_with_positive_overflow()\r\n    {\r\n        var cth = new CalculatorTestHarness(new Calculator());\r\n        Assert.Equal(\"Multiply failed for mixed or positive operands. Arithmetic operation resulted in an overflow.\",\r\n            cth.TestMultiplication(Int32.MaxValue, Int32.MaxValue));\r\n    }\r\n}\r\n"
  }
}