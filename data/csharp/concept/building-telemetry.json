{
  "language": "csharp",
  "slug": "building-telemetry",
  "docs": {
    "introduction": "# Introduction\r\n\r\n## Parameters\r\n\r\nThis exercise discusses some details of method parameters and their use in C#.\r\n\r\nParameters convey information from a calling method to a called method.\r\n\r\n- The behavior of parameters can be modified by the use of modifiers such as `ref` and `out`.\r\n\r\n- A parameter with the `out` modifier conveys a value back from the called method to the caller. The parameter can be passed to the called method without being initialized and in any case it is treated within the called method as if, on entry, it had not been initialized. An understanding of the behavior and rules regarding parameter modifiers can be gained most easily through examples (see below) and compiler messages.\r\n\r\n```csharp\r\nvoid Foo(out int val)\r\n{\r\n    val = 42;\r\n}\r\nvoid Bar(int val)\r\n{\r\n    val = 42;\r\n}\r\n\r\nint importantValue = 1729;\r\nFoo(out importantValue);\r\nvar result = importantValue == 42;\r\n// => true\r\n\r\nimportantValue = 1729;\r\nBar(importantValue);\r\nresult = importantValue == 1729;\r\n// => true\r\n```\r\n\r\n- `out` parameters must be assigned to within a called method.\r\n\r\n- A parameter with the `ref` modifier passes a value into a called method. When the method returns the caller will find any updates made by the called method in that parameter.\r\n\r\n```csharp\r\nvoid Foo(ref int val)\r\n{\r\n    val *= 7;\r\n}\r\n\r\nint importantValue = 6;\r\nFoo(ref importantValue);\r\nreturn importantValue;\r\n// => 42\r\n```\r\n\r\n- `ref` parameters must be variables as the called method will be operating directly on the parameter as seen by the caller.\r\n- The `out` and `ref` modifiers are required both in the called method signature and at the call site.\r\n",
    "instructions": "# Instructions\r\n\r\nThe remote control car project you kicked off in the `classes` exercise has gone well (congratulations!) and due to a number of recent sponsorship deals there is money in the budget for enhancements.\r\n\r\nPart of the budget is being used to provide some telemetry.\r\n\r\nTo keep the sponsors sweet a panel has been installed on the car to display the sponsors names as it goes round the track.\r\n\r\nYou will note that the introduction of these fancy new technologies has dramatically reduced the car's battery life.\r\n\r\n## 1. Enable the remote control car to display sponsor names\r\n\r\nImplement `SetSponsors()` to take one or more sponsor names and store them on the car.\r\n\r\nNote that the `SetSponsors()` method's argument is guaranteed to be non-null.\r\n\r\nImplement `DisplaySponsor()` to display the selected sponsor. The first sponsor passed in has a `sponsorNum` of 0, the second, 1 etc.\r\n\r\n```csharp\r\nvar car = RemoteControlCar.Buy();\r\ncar.SetSponsors(\"Exercism\", \"Walker Industries\", \"Acme Co.\");\r\nvar sp2 = car.DisplaySponsor(sponsorNum: 1);\r\n// => \"Walker Industries\"\r\n```\r\n\r\n## 2. Get the car's telemetry data\r\n\r\nImplement the `RemoteControlCar.GetTelemetryData()` method.\r\n\r\n`GetTelemetryData()` should make the battery percentage and distance driven in meters available via `out` parameters.\r\n\r\n`GetTelemetryData()` should return `false` if the serialNum argument is less than the previously received value. (There is some issue of multiple telemetry nodes being involved). In this case `serialNum` will be set to the highest previous `serialNum` and battery percentage and meters driven will both be set to `-1`. Where the call is successful `serialNum` remains unchanged.\r\n\r\n```csharp\r\nvar car = RemoteControlCar.Buy();\r\ncar.Drive();\r\ncar.Drive();\r\nint serialNum = 4;\r\ncar.GetTelemetryData(ref serialNum, out int batteryPercentage, out int distanceDrivenInMeters);\r\n// => true, 4L, 80, 4\r\n\r\nserialNum = 1;\r\ncar.GetTelemetryData(ref serialNum, out batteryPercentage, out distanceDrivenInMeters);\r\n// => false, 4L, -1, -1\r\n```\r\n\r\n## 3. Add functionality so that the telemetry system can get battery usage per meter\r\n\r\nImplement the `TelemetryClient.GetBatteryUsagePerMeter()` method.\r\n\r\nThis will call `RemoteControlCar.GetTelemetryData()`. If `GetTelemetryData()` returns `false` or the car has not been driven, then this routine should return \"no data\". If `GetTelemetryData()` returns `true` then a message in the following form should be returned \"usage-per-meter=BATTERY-USAGE-PER-METER\". Where the calculation is (100 - current battery percentage) divided by the distance driven in meters so far.\r\n\r\n```csharp\r\nvar car = RemoteControlCar.Buy();\r\ncar.Drive();\r\ncar.Drive();\r\nvar tc = new TelemetryClient(car);\r\nint serialNum = 4;\r\ntc.GetBatteryUsagePerMeter(serialNum);\r\n// => \"usage-per-meter=5\"\r\n\r\nserialNum = 1;\r\ntc.GetBatteryUsagePerMeter(serialNum);\r\n// => \"no data\"\r\n```\r\n",
    "hints": "# Hints\r\n\r\n## General\r\n\r\n- [passing-parameters][passing-parameters]: explains how values can be passed as arguments.\r\n- [ref-parameter][ref-parameter]: describes how `ref` parameters work.\r\n- [out-parameter][out-parameter]: describes how `out` parameters work.\r\n\r\n## 1. Enable the remote control car to display sponsor names\r\n\r\nThis [article][passing-parameters] discusses how to implement a method which takes a variable number of arguments.\r\n\r\n## 2 Get the car's telemetry data\r\n\r\nTo perform this task you need to know how to deal with both [out][out-parameter] and [ref][ref-parameter] parameters.\r\n\r\n[passing-parameters]: https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/passing-parameters\r\n[ref-parameter]: https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/ref#passing-an-argument-by-reference\r\n[out-parameter]: https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/out-parameter-modifier\r\n"
  },
  "starter_code": {
    "BuildingTelemetry.cs": "public class RemoteControlCar\r\n{\r\n    private int batteryPercentage = 100;\r\n    private int distanceDrivenInMeters = 0;\r\n    private string[] sponsors = new string[0];\r\n    private int latestSerialNum = 0;\r\n\r\n    public void Drive()\r\n    {\r\n        if (batteryPercentage > 0)\r\n        {\r\n            batteryPercentage -= 10;\r\n            distanceDrivenInMeters += 2;\r\n        }\r\n    }\r\n\r\n    public void SetSponsors(params string[] sponsors)\r\n    {\r\n        throw new NotImplementedException(\"Please implement the RemoteControlCar.SetSponsors() method\");\r\n    }\r\n\r\n    public string DisplaySponsor(int sponsorNum)\r\n    {\r\n        throw new NotImplementedException(\"Please implement the RemoteControlCar.DisplaySponsor() method\");\r\n    }\r\n\r\n    public bool GetTelemetryData(ref int serialNum,\r\n        out int batteryPercentage, out int distanceDrivenInMeters)\r\n    {\r\n        throw new NotImplementedException(\"Please implement the RemoteControlCar.GetTelemetryData() method\");\r\n    }\r\n\r\n    public static RemoteControlCar Buy()\r\n    {\r\n        return new RemoteControlCar();\r\n    }\r\n}\r\n\r\npublic class TelemetryClient\r\n{\r\n    private RemoteControlCar car;\r\n\r\n    public TelemetryClient(RemoteControlCar car)\r\n    {\r\n        this.car = car;\r\n    }\r\n\r\n    public string GetBatteryUsagePerMeter(int serialNum)\r\n    {\r\n        throw new NotImplementedException(\"Please implement the TelemetryClient.GetBatteryUsagePerMeter() method\");\r\n    }\r\n}\r\n"
  },
  "tests": {
    "BuildingTelemetryTests.cs": "using Exercism.Tests;\r\n\r\npublic class BuildingTelemetryTests\r\n{\r\n    [Fact]\r\n    [Task(1)]\r\n    public void DisplayNextSponsor_for_3_sponsors()\r\n    {\r\n        var car = RemoteControlCar.Buy();\r\n        car.SetSponsors(\"Exercism\", \"Walker Industries\", \"Acme Co.\");\r\n        var sp1 = car.DisplaySponsor(sponsorNum: 0);\r\n        var sp2 = car.DisplaySponsor(sponsorNum: 1);\r\n        var sp3 = car.DisplaySponsor(sponsorNum: 2);\r\n        Assert.Equal((sp1, sp2, sp3), (\"Exercism\", \"Walker Industries\", \"Acme Co.\"));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(2)]\r\n    public void GetTelemetryData_good()\r\n    {\r\n        var car = RemoteControlCar.Buy();\r\n        car.Drive();\r\n        car.Drive();\r\n        int serialNum = 1;\r\n        var result = car.GetTelemetryData(ref serialNum, out int batteryPercentage, out int distanceDrivenInMeters);\r\n        Assert.True(result);\r\n        Assert.Equal((1, 80, 4), (serialNum, batteryPercentage, distanceDrivenInMeters));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(2)]\r\n    public void GetTelemetryData_bad()\r\n    {\r\n        var car = RemoteControlCar.Buy();\r\n        int batteryPercentage, distanceDrivenInMeters;\r\n        car.Drive();\r\n        car.Drive();\r\n        int serialNum = 4;\r\n        car.GetTelemetryData(ref serialNum, out batteryPercentage, out distanceDrivenInMeters);\r\n        serialNum = 1;\r\n        bool result = car.GetTelemetryData(ref serialNum, out batteryPercentage, out distanceDrivenInMeters);\r\n        Assert.False(result);\r\n        Assert.Equal((4, -1, -1), (serialNum, batteryPercentage, distanceDrivenInMeters));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(3)]\r\n    public void GetUsagePerMeter_good()\r\n    {\r\n        var car = RemoteControlCar.Buy();\r\n        car.Drive(); car.Drive();\r\n        var tc = new TelemetryClient(car);\r\n        Assert.Equal(\"usage-per-meter=5\", tc.GetBatteryUsagePerMeter(serialNum: 1));\r\n    }\r\n\r\n    [Fact]\r\n    [Task(3)]\r\n    public void GetUsagePerMeter_not_started()\r\n    {\r\n        var car = RemoteControlCar.Buy();\r\n        var tc = new TelemetryClient(car);\r\n        Assert.Equal(\"no data\", tc.GetBatteryUsagePerMeter(serialNum: 1));\r\n    }\r\n}\r\n"
  }
}