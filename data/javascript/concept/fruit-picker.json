{
  "language": "javascript",
  "slug": "fruit-picker",
  "title": "Fruit Picker",
  "docs": {
    "introduction": "# Introduction\n\n## Callback functions\n\nCallback functions are functions passed as arguments.\nThis programming pattern creates a sequence of function calls in both synchronous and asynchronous programming.\nWriting a callback function is no different from writing a function; however, the callback function must match the signature defined by the calling function.\n\n```javascript\nconst squareLength = 5;\n\n// Caller function takes a callback function\nfunction applyToSquare(callback) {\n  return callback(squareLength);\n}\n\n// Callback must expect the possible argument from the calling function\nfunction areaOfSquare(number) {\n  return number * number;\n}\n\napplyToSquare(areaOfSquare); // => 25\n```\n\nYou may also write callbacks as a function expression, anonymous function expression, or arrow function expression:\n\n```javascript\napplyToSquare(function squarePerimeter(side) {\n  return side * 4;\n});\n\napplyToSquare(function (side) {\n  return side * 4;\n});\n\napplyToSquare((side) => {\n  return side * 4;\n});\n```\n",
    "instructions": "# Instructions\n\nYou are creating a new online portal for your patrons to order their fruit fresh from the grocer.\nThe grocer has an API that you can use to see if they have the inventory desired by your customers.\nYou need to create a small library of functions for interacting with the grocer's API.\n\n## 1. Notify your customer when their order was successful\n\nThe portal should notify your customer if their order was successful.\nDefine the `onSuccess` callback function that will be called if the order was successful due to the grocer having enough fruit in stock.\nThis function should invoke the imported `notify` function, passing `{ message: 'SUCCESS' }` to let your customer know that their order was successful.\n\n```javascript\nonSuccess();\n// => `notify` called with `{ message: 'SUCCESS' }`\n```\n\n## 2. Notify your customer when their order was unsuccessful\n\nThe portal should notify your customer if their order was unsuccessful.\nDefine the `onError` callback function that will be called if the order was unsuccessful because the grocer _does not have_ the fruit in stock or there was an error.\nThis function should invoke the imported `notify` function, passing `{ message: 'ERROR' }` to let your customer know that their order was unsuccessful.\n\n```javascript\nonError();\n// => `notify` called with `{ message: 'ERROR' }`\n```\n\n## 3. Create an API wrapper to wrap the grocer's API order function\n\nFruit orders are placed through the grocer's API via the provided `order` function.\nThis function receives three arguments: a _query_, containing the `variety` and `quantity` of fruit requested, a _callback_ function to be invoked when the order is successful, and a _callback_ function to be invoked when the order encounters an error.\n\nYou want to insulate your codebase from potential external changes and decide to wrap the call to the `order` function inside a new function named `orderFromGrocer`.\nImplement the `orderFromGrocer` function that attempts to place an order via a call to the grocer's API `order` function, making sure to forward the arguments passed into `orderFromGrocer` to the API call.\n\nThe query takes the form of an _object_:\n\n```typescript\nconst query = {\n  variety: string,\n  quantity: number,\n};\n```\n\n```javascript\norderFromGrocer(\n  { variety: 'pear', quantity: 12 },\n  exampleSuccessCallback,\n  exampleErrorCallback,\n);\n// => `order` was called with the query and the callbacks\n```\n\n## 4. Simplify handling placed orders\n\nYour customers are now able to place fruit orders via your portal, however, you notice that you are invoking the `orderFromGrocer` function in many different places across your codebase, each time having to pass in a `query` and the two `callback` functions as arguments.\nSeeing an opportunity to refactor your code, you think it would be simpler if you could place an order by just passing the `variety` and `quantity` of fruit required.\nDefine the `postOrder` helper function that takes `variety` and `quantity` as arguments and attempts to place an order with the grocer.\n\n```javascript\npostOrder('peach', 100);\n// => order placed for 100 peaches\n```\n",
    "hints": "# Hints\n\n## General\n\n- Callback functions are functions passed as an argument to a calling function.\n- Callback functions must meet the specification of the calling function.\n\n## 1. Notify with a successful message\n\n- Use the imported API function `notify` in your function.\n- Pass an object to `notify`. It should have a property of `message`. Think about what the message value should be.\n- Pay attention to the JSDoc type hint -- the function should not return a value.\n\n## 2. Notify with an error message\n\n- Use the imported API function `notify` in your function.\n- Pass another object to `notify`. It should have a property of `message`. The message value should differ from the last part.\n- Pay attention to the comments [JSDoc] above the function definition:\n  - The function should not return a value.\n\n## 3. Place an order to buy fruit\n\n- Use the already imported `order` function.\n- Pay attention to the JSDoc type hints -- the function should receive 3 arguments and not return a value.\n- Reuse the previously created callbacks as arguments to the order function.\n\n## 4. Refactor your work into a more concise function\n\n- Reuse the functions from the previous tasks.\n- Pay attention to the JSDoc type hints -- the function should receive 2 arguments and not return a value.\n- Combine the arguments into an object representing the query to the grocer to place an order.\n"
  },
  "starter_code": "/// <reference path=\"../global.d.ts\" />\n//\n// @ts-check\n\nimport { notify } from './notifier';\nimport { order } from './grocer';\n\n/**\n * @return void\n */\nexport function onSuccess() {\n  notify({ message: 'SUCCESS' });\n}\n\n/**\n * @return void\n */\nexport function onError() {\n  notify({ message: 'ERROR' });\n}\n\n/**\n * @param {GrocerQuery} query\n * @param {FruitPickerSuccessCallback} onSuccessCallback\n * @param {FruitPickerErrorCallback} onErrorCallback\n * @return void\n */\nexport function orderFromGrocer(query, onSuccessCallback, onErrorCallback) {\n  order(query, onSuccessCallback, onErrorCallback);\n}\n\n/**\n * @param {string} variety\n * @param {number} quantity\n * @return void\n */\nexport function postOrder(variety, quantity) {\n  orderFromGrocer({ variety, quantity }, onSuccess, onError);\n}\n",
  "tests": "import { afterEach, describe, expect, test, jest } from '@jest/globals';\nimport { onError, onSuccess, orderFromGrocer, postOrder } from './fruit-picker';\nimport { order } from './grocer';\nimport { notify } from './notifier';\n\njest.mock('./notifier', () => ({\n  notify: jest.fn(),\n}));\n\njest.mock('./grocer', () => ({\n  order: jest.fn(),\n}));\n\nafterEach(() => {\n  jest.resetAllMocks();\n});\n\ndescribe('task 1', () => {\n  test('onSuccess should call notify with a success message', () => {\n    expect(onSuccess()).toEqual(undefined);\n    expect(notify).toHaveBeenCalledTimes(1);\n    expect(notify).toHaveBeenCalledWith({ message: 'SUCCESS' });\n  });\n});\n\ndescribe('task 2', () => {\n  test('onError should call notify with an error message', () => {\n    expect(onError()).toEqual(undefined);\n    expect(notify).toHaveBeenCalledTimes(1);\n    expect(notify).toHaveBeenCalledWith({ message: 'ERROR' });\n  });\n});\n\ndescribe('task 3', () => {\n  test('orderFromGrocer passes query and callback function arguments forward', () => {\n    const query = { variety: 'apple', quantity: 10 };\n    orderFromGrocer(query, onSuccess, onError);\n    expect(order).toHaveBeenCalledTimes(1);\n    expect(order).toHaveBeenCalledWith(query, onSuccess, onError);\n  });\n});\n\ndescribe('task 4', () => {\n  test('postOrder composes a request to the grocer using the defined callbacks', () => {\n    const variety = 'banana';\n    const quantity = 5;\n    postOrder(variety, quantity);\n\n    expect(order).toHaveBeenCalledTimes(1);\n    expect(order).toHaveBeenCalledWith(\n      { variety, quantity },\n      onSuccess,\n      onError,\n    );\n  });\n});\n"
}