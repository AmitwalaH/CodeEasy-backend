{
  "language": "python",
  "type": "practice",
  "slug": "dot-dsl",
  "title": "Dot Dsl",
  "docs": {
    "instructions": "# Instructions\r\n\r\nA [Domain Specific Language (DSL)][dsl] is a small language optimized for a specific domain.\r\nSince a DSL is targeted, it can greatly impact productivity/understanding by allowing the writer to declare _what_ they want rather than _how_.\r\n\r\nOne problem area where they are applied are complex customizations/configurations.\r\n\r\nFor example the [DOT language][dot-language] allows you to write a textual description of a graph which is then transformed into a picture by one of the [Graphviz][graphviz] tools (such as `dot`).\r\nA simple graph looks like this:\r\n\r\n    graph {\r\n        graph [bgcolor=\"yellow\"]\r\n        a [color=\"red\"]\r\n        b [color=\"blue\"]\r\n        a -- b [color=\"green\"]\r\n    }\r\n\r\nPutting this in a file `example.dot` and running `dot example.dot -T png -o example.png` creates an image `example.png` with red and blue circle connected by a green line on a yellow background.\r\n\r\nWrite a Domain Specific Language similar to the Graphviz dot language.\r\n\r\nOur DSL is similar to the Graphviz dot language in that our DSL will be used to create graph data structures.\r\nHowever, unlike the DOT Language, our DSL will be an internal DSL for use only in our language.\r\n\r\n[Learn more about the difference between internal and external DSLs][fowler-dsl].\r\n\r\n[dsl]: https://en.wikipedia.org/wiki/Domain-specific_language\r\n[dot-language]: https://en.wikipedia.org/wiki/DOT_(graph_description_language)\r\n[graphviz]: https://graphviz.org/\r\n[fowler-dsl]: https://martinfowler.com/bliki/DomainSpecificLanguage.html\r\n",
    "hints": ""
  },
  "starter_code": "NODE, EDGE, ATTR = range(3)\r\n\r\n\r\nclass Node:\r\n    def __init__(self, name, attrs):\r\n        self.name = name\r\n        self.attrs = attrs\r\n\r\n    def __eq__(self, other):\r\n        return self.name == other.name and self.attrs == other.attrs\r\n\r\n\r\nclass Edge:\r\n    def __init__(self, src, dst, attrs):\r\n        self.src = src\r\n        self.dst = dst\r\n        self.attrs = attrs\r\n\r\n    def __eq__(self, other):\r\n        return (self.src == other.src and\r\n                self.dst == other.dst and\r\n                self.attrs == other.attrs)\r\n\r\n\r\nclass Graph:\r\n    def __init__(self, data=None):\r\n        pass\r\n",
  "tests": "import unittest\r\n\r\nfrom dot_dsl import Graph, Node, Edge, NODE, EDGE, ATTR\r\n\r\n\r\nclass DotDslTest(unittest.TestCase):\r\n    def test_empty_graph(self):\r\n        g = Graph()\r\n\r\n        self.assertEqual(g.nodes, [])\r\n        self.assertEqual(g.edges, [])\r\n        self.assertEqual(g.attrs, {})\r\n\r\n    def test_graph_with_one_node(self):\r\n        g = Graph([\r\n            (NODE, \"a\", {})\r\n        ])\r\n\r\n        self.assertEqual(g.nodes, [Node(\"a\", {})])\r\n        self.assertEqual(g.edges, [])\r\n        self.assertEqual(g.attrs, {})\r\n\r\n    def test_graph_with_one_node_with_keywords(self):\r\n        g = Graph([\r\n            (NODE, \"a\", {\"color\": \"green\"})\r\n        ])\r\n\r\n        self.assertEqual(g.nodes, [Node(\"a\", {\"color\": \"green\"})])\r\n        self.assertEqual(g.edges, [])\r\n        self.assertEqual(g.attrs, {})\r\n\r\n    def test_graph_with_one_edge(self):\r\n        g = Graph([\r\n            (EDGE, \"a\", \"b\", {})\r\n        ])\r\n\r\n        self.assertEqual(g.nodes, [])\r\n        self.assertEqual(g.edges, [Edge(\"a\", \"b\", {})])\r\n        self.assertEqual(g.attrs, {})\r\n\r\n    def test_graph_with_one_attribute(self):\r\n        g = Graph([\r\n            (ATTR, \"foo\", \"1\")\r\n        ])\r\n\r\n        self.assertEqual(g.nodes, [])\r\n        self.assertEqual(g.edges, [])\r\n        self.assertEqual(g.attrs, {\"foo\": \"1\"})\r\n\r\n    def test_graph_with_attributes(self):\r\n        g = Graph([\r\n            (ATTR, \"foo\", \"1\"),\r\n            (ATTR, \"title\", \"Testing Attrs\"),\r\n            (NODE, \"a\", {\"color\": \"green\"}),\r\n            (NODE, \"c\", {}),\r\n            (NODE, \"b\", {\"label\": \"Beta!\"}),\r\n            (EDGE, \"b\", \"c\", {}),\r\n            (EDGE, \"a\", \"b\", {\"color\": \"blue\"}),\r\n            (ATTR, \"bar\", \"true\")\r\n        ])\r\n\r\n        self.assertEqual(g.nodes, [Node(\"a\", {\"color\": \"green\"}),\r\n                                   Node(\"c\", {}),\r\n                                   Node(\"b\", {\"label\": \"Beta!\"})])\r\n        self.assertEqual(g.edges, [Edge(\"b\", \"c\", {}),\r\n                                   Edge(\"a\", \"b\", {\"color\": \"blue\"})])\r\n        self.assertEqual(g.attrs, {\r\n            \"foo\": \"1\",\r\n            \"title\": \"Testing Attrs\",\r\n            \"bar\": \"true\"\r\n        })\r\n\r\n    def test_malformed_graph(self):\r\n        with self.assertRaises(TypeError) as err:\r\n            Graph(1)\r\n        self.assertEqual(type(err.exception), TypeError)\r\n        self.assertEqual(err.exception.args[0], \"Graph data malformed\")\r\n\r\n        with self.assertRaises(TypeError) as err:\r\n            Graph(\"problematic\")\r\n        self.assertEqual(type(err.exception), TypeError)\r\n        self.assertEqual(err.exception.args[0], \"Graph data malformed\")\r\n\r\n    def test_malformed_graph_item(self):\r\n        with self.assertRaises(TypeError) as err:\r\n            Graph([()])\r\n        self.assertEqual(type(err.exception), TypeError)\r\n        self.assertEqual(err.exception.args[0], \"Graph item incomplete\")\r\n\r\n\r\n        with self.assertRaises(TypeError) as err:\r\n                Graph([(ATTR, )])\r\n        self.assertEqual(type(err.exception), TypeError)\r\n        self.assertEqual(err.exception.args[0], \"Graph item incomplete\")\r\n\r\n\r\n    def test_malformed_attr(self):\r\n        with self.assertRaises(ValueError) as err:\r\n            Graph([(ATTR, 1, 2, 3)])\r\n        self.assertEqual(type(err.exception), ValueError)\r\n        self.assertEqual(err.exception.args[0], \"Attribute is malformed\")\r\n\r\n\r\n    def test_malformed_node(self):\r\n        with self.assertRaises(ValueError) as err:\r\n            Graph([(NODE, 1, 2, 3)])\r\n        self.assertEqual(type(err.exception), ValueError)\r\n        self.assertEqual(err.exception.args[0], \"Node is malformed\")\r\n\r\n\r\n    def test_malformed_EDGE(self):\r\n        with self.assertRaises(ValueError) as err:\r\n            Graph([(EDGE, 1, 2)])\r\n        self.assertEqual(type(err.exception), ValueError)\r\n        self.assertEqual(err.exception.args[0], \"Edge is malformed\")\r\n\r\n    def test_unknown_item(self):\r\n        with self.assertRaises(ValueError) as err:\r\n            Graph([(99, 1, 2)])\r\n        self.assertEqual(type(err.exception), ValueError)\r\n        self.assertEqual(err.exception.args[0], \"Unknown item\")\r\n"
}